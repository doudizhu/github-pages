{"version":3,"sources":["webpack:///./src/views/project/Order.vue?3b99","webpack:///./src/views/project/Order.vue?e6b9","webpack:///./src/views/project/Order.vue?6166","webpack:///./src/views/project/Order.vue","webpack:///./src/utils/index.ts"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","model","schema","on","submitHandler","staticRenderFns","userInfo","orderInfo","selectedLabel","amount","fields","type","modelKey","label","props","placeholer","clearable","rules","required","trigger","messages","getInvestUserInfo","getInvestOrder","e","preventDefault","applyedCA","$request","api","token","$store","state","params","projectNo","$route","id","originReturnUrl","originNodeServer","rewardAmt","couponIds","acceptedAgreement","transferRiskRemind","bondInvestAgreement","returnUrl","method","data","resCode","formSubmitData","url","shUrl","$router","push","components","component","debounce","fn","delay","timer","args","arguments","context","clearTimeout","setTimeout","apply","isEmpty","value","undefined","Object","keys","length","trim","getArrayObjIndexByKey","array","keyObj","newIndex","key","val","some","item","index"],"mappings":"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","file":"js/chunk-729e6399.c0560f65.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"view\"},[_c('cube-form',{attrs:{\"model\":_vm.model,\"schema\":_vm.schema},on:{\"submit\":_vm.submitHandler}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\nimport { getUrlParam } from '@/utils/common.ts'\nimport { isEmpty } from '@/utils'\nimport { Component, Vue } from 'vue-property-decorator';\n@Component({\n  components: {},\n})\nexport default class ViewComponent extends Vue {\n  /**data */\n  userInfo:any = {}\n  orderInfo:any = {}\n  selectedLabel = '' // 充值页，结果页\n  model = {\n    amount: '',\n  }\n  schema = {\n    fields: [\n      {\n        type: \"input\",\n        modelKey: \"amount\",\n        label: \"￥\",\n        props: {\n          placeholer: \"输入金额\",\n          clearable: true,\n        },\n        rules: {\n          required: true,\n        },\n        trigger: \"blur\",// *待优化：这样会触发多次异步请求校验。思路一：仅当提交表单时才发起一次异步校验\n        messages: {\n          required: \"不能为空\",\n        },\n      },\n      {\n        type: \"submit\",\n        label: \"确认\"\n      }\n    ]\n  }\n\n  /**life hook */\n  created(){\n    this.getInvestUserInfo();\n    this.getInvestOrder();\n  }\n\n  /**method */\n  async submitHandler(e: any) {\n    e.preventDefault();\n    if(isEmpty(this.userInfo) || isEmpty(this.orderInfo)) return;\n\n    // 1.申请CA \n    if(!this.userInfo.applyedCA){\n      this.$request({\n        api:'applyCA',\n        token:this.$store.state.token,\n      })\n    }\n\n    // 2.中间页跳转申请\n    const data = await this.$request({\n      api: 'investConfirm', // 2.充值确认  --懒猫充值相关\n      params: {\n        amount: this.model.amount,\n        projectNo: this.$route.params.id,\n        originReturnUrl:this.$store.state.originNodeServer,\n\n        token:this.$store.state.token,\n        rewardAmt:0,\n        couponIds:'',\n        acceptedAgreement:true,\n        transferRiskRemind:true,\n        bondInvestAgreement:true,\n        returnUrl:`${this.$store.state.originNodeServer}/project/investReturn`,\n      },\n      method:'post',\n    })\n\n    if(data.resCode === '0000'){\n      this.$request({\n        formSubmitData:{\n          url:data.shUrl,\n          params:data.params,\n          returnUrl:data.returnUrl,\n        }\n      })\n    }\n    else{\n      if(data.resCode !==  'E1070044'){\n        this.$router.push('/project/investReturn?result=false')\n      }\n    }\n  }\n\n  async getInvestUserInfo() {\n    const data = await this.$request({\n      api: 'getInvestUserInfo', // 投资订单页获取用户信息\n      params: {\n        projectNo: this.$route.params.id,\n        token:this.$store.state.token,\n      },\n    })\n\n    if(data.resCode === '0000'){\n      this.userInfo = data\n    }\n  }\n  async getInvestOrder() {\n    const data = await this.$request({\n      api: 'getInvestOrder', // 项目投资订单页\n      params: {\n        projectNo: this.$route.params.id,\n        token:this.$store.state.token,\n      },\n    })\n\n    if(data.resCode === '0000'){\n      this.orderInfo = data\n    }\n  }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??ref--17-2!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Order.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??ref--17-2!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Order.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Order.vue?vue&type=template&id=a974281a&lang=pug&\"\nimport script from \"./Order.vue?vue&type=script&lang=ts&\"\nexport * from \"./Order.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/**\n * 去抖\n * *待优化：为可传参形式\n * @param {*} fn // 回调方法\n * @param {*} delay // 延迟执行时间\n */\nexport function debounce (fn:any, delay=400) {\n  let timer:any = null;\n\n  return function(this:any) {\n    let args = arguments; // 回调方法参数\n    let context = this; // 自身上下文\n\n    if (timer) { // 每次触发后清除时间函数值\n      clearTimeout(timer);\n    }\n    \n    timer = setTimeout(function () {\n      fn.apply(context, args);\n    }, delay);\n  }\n}\n\n/**\n * 校验为空，忽略数据格式\n * @param value \n */\nexport function isEmpty (value:any){\n  return (\n    value === undefined\n    || null\n    || (typeof value === 'object' && Object.keys(value).length === 0)\n    || (typeof value === 'string' && value.trim().length === 0)\n  )\n}\n\n/**\n * 获取数组对象索引（对个单个属性匹配）\n */\nexport function getArrayObjIndexByKey(array:any,keyObj:any){\n  let newIndex = -1\n\n  const key = Object.keys(keyObj)[0]\n  const val = keyObj[key]\n  array.some((item:any,index:number)=>{\n    if(item[key] == val){\n      newIndex = index;\n      return true;\n    }\n  })\n  return newIndex\n}"],"sourceRoot":""}